# **Урок 1. Создание бота, установка библиотеки. Создание инлайн-кнопок**
**В этом уроке мы рассмотрим методы:<br>**
1. Telebot()
2. send_message()
3. reply_to()
4. webbrowser.open()
---
## **Создание бота в телеграмм**
1. Переходим в [BotFather](https://t.me/BotFather), запускаем бота `/start` и создаём бота `/newbot`
2. Далее следуем инструкции: в первой строке пишем имя, во второй строке тег бота
3. Если хочешь украсить бота: добавить картинку или описание, например, то изучи самостоятельно в **BotFather**, как это сделать (очень удобно, что все комманды там с описанием).
---
## Установка библиотеки
1. Устанавливаем **pip** <br>
    ```bash
   sudo apt install python3-pip
    ```
2. Далее устанавливаем библиотеку `telebot`
    ```bash
   pip install pyTelegramBotAPI
    ```
3. Готово, теперь создадим файл, в котором напишем первый простой функционал бота

## Создаём своего бота телеграмм. Урок 1

Мы используем библиотеку `telebot`, подлючим её в начале кода с помощью ```import telebot```. С помощью этой библиотеки и токена подлючимся к нашему боту. <br>
Токен бота можно получить в **BotFather**, он отправляет сообщение с токеном бота. Создадим переменную `bot` для простого обращения к нашему боту и подключимся к нему с помощью метода `Telebot`:<br>
```python3
    import telebot
    # в скобках указываем токен бота
    bot = telebot.TeleBot('7565587134:AAHoyiepbUxuXBjEZwL_AL1VFJ598KdhEJ0')
```
<br>
Готово, теперь мы можем "творить" <br>
Научим бота здоровоться с нами, для этого пропишем декоратор для функции и в аргументах укажем команды, на которые будет реагировать бот:<br>

```python3
    @bot.message_handler(commands=['start'])
    # теперь напишем боту, что он будет делать, если увидит комманду start
    def start(message):
        """мы на вход получили message - сообщение, которое отправил пользователь
        теперь обработаем его и отправим приветственное сообщение. Чтобы отправить сообщение,
        боту нужно знать чат, куда его отправлять. С помощью message.chat.id - можем узнать id чата.
        Теперь с помощью метода send_message() скажем боту куда и что отправлять, в первый аргумент 
        передадим id чата, а во второй текст
        """
        bot.send_message(message.chat.id, 'Привет!')
```
Круто, теперь если нашему боту отправить `/start`, он будет здоровоться. <br>
Теперь научим бота выводить информацию, если пользователь хочет узнать, что бот ещё умеет:
```python3
    @bot.message_handler(commands=['help'])
    def help(message):
        # отправляем сообщение с помощью метода send_message, в параметрах указываем айди чата с помощью метода chat.id и пишем сообщение
        bot.send_message(message.chat.id, 'Help information!')
        """а здесь вот интересный момент, мы можем парсить строку, передав третий аргумент.
        Давай сделаем нашу строку красивой, с помощью <b>Help</b> <em><u>information</u></em>!' мы сделаем
        'Help' - жирным, а 'information' - курсивным и подчёркнутым. Дальше нам надо сказать боту, как он должен
        интерпретировать (понимать) то, что мы написали, с помощью 3-его аргумента скажем ему: parse_mode='html'
        """
        bot.send_message(message.chat.id, '<b>Help</b> <em><u>information</u></em>!', parse_mode='html')
``` 


Наш бот теперь реагирует на команды `/start` и `/help`. Попробуй запустить код и написать что-то в бота. Спойлер - ты увидишь, что бот не работает) <br>
Это возникает из-за того, что бот знает, что делать, пока наша программа работает, у нас она после выполнения кода завершается. <br>
Сделаем, чтобы наш код работал постоянно. Это просто, допишем команду: <br>
```python3
    # метод polling() с включённым флагом `non_stop=true` говорит программе, чтобы она работала постоянно
    bot.polling(non_stop=true)
```
*p.s: пиши это в конце кода, иначе после этой строчки код будет считать недостижимым* <br>

Попробуй теперь запустить код и ты увидишь, что твой бот работает корректно. Теперь давай научим нашего ботать открывать сайты. <br>
Например, тебе понравился проект разработчика и ты хочешь посмотреть ещё его детища, вот пусть наш бот по команде `/site` <br>
перекидывает пользователя на сайт, сделать это можно с помощью встроенной библиотеки `webbrowser` и метода `open()`:
```python3
    import webbrowser

    @bot.message_handler(commands=['site'])
    def site():
        webbrowser.open('https://gitlab.com/erp_tern_2/chatgpt-api-bot')
```
Огонь, теперь по команде `/site` мы будем попадать в репозиторий с открытым кодом этого бота. <br>
Наверное, тебе приходилось узнавать информацию о своём `id` в телеграмме или может нужно было узнать `id` другого пользователя. <br>
Так вот, по одному твоёму сообщению можно узнать многое, давай посмотрим, что выведет бот в таком случае: <br>
```python3 
    @bot.message_handler(commands=['user'])
    def user_information(message):
    # посмотрим, что выведет, если передать в метод send_message сообщение, которое написал юзер
    bot.send_message(message.chat.id, f'Из этого сообщения можно получить всю информацию о тебе:\n\n {message})')
    # получим имя пользователя, фамилию и айди
    bot.send_message(message.chat.id,
                     f'Вот, например \nТвоё имя: {message.from_user.first_name}, фамилия: {message.from_user.last_name}, id: {message.from_user.id}')
```
Прикольно?) Знаю, что да:) <br>

Как работать с уже заготовленными коммандами мы бота научили, а что если научить бота общаться с пользователем. Например, чтобы пользователь вводил "привет" и бот <br>
с ним здороволся, или же пользователь вводил `id`, и бот давал информацию об `id` пользователя. Давай покажу, как это реализовать: <br>
```python3
    # обрабатываем текст, который поступает от пользователя
    @bot.message_handler()
    def test(message):
        if message.text.lower() == 'привет':
            bot.send_message(message.chat.id, f'Привет, {message.from_user.last_name} {message.from_user.first_name}.')
        elif message.text.lower() == 'id':
            bot.send_message(message.chat.id, message.from_user.id)
        # рассмотрим метод, который позволяет "отвечать" на сообщение пользователя с помощью метода reply_to
        elif message.text.lower() == 'как дела?':
            bot.reply_to(message, 'Норм, а у тя?')
```
*p.s: не нужно писать этот код в начале, иначе метод будет срабатывать каждый раз и код ниже будет недостижимым*

Круть, теперь наш бот уже многое умеет, весь код можешь найти в репозитории по пути: <br>
`education/lesson_1/lesson_1.py`

